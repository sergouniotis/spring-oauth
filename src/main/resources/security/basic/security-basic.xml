<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
	xmlns:aop="http://www.springframework.org/schema/aop" xmlns:jpa="http://www.springframework.org/schema/data/jpa"
	xmlns:tx="http://www.springframework.org/schema/tx" xmlns:task="http://www.springframework.org/schema/task"
	xmlns:sec="http://www.springframework.org/schema/security"
	xmlns:oauth2="http://www.springframework.org/schema/security/oauth2"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans.xsd
http://www.springframework.org/schema/context
http://www.springframework.org/schema/context/spring-context.xsd
http://www.springframework.org/schema/aop
http://www.springframework.org/schema/aop/spring-aop.xsd 
http://www.springframework.org/schema/data/jpa 
http://www.springframework.org/schema/data/jpa/spring-jpa.xsd 
http://www.springframework.org/schema/task
http://www.springframework.org/schema/task/spring-task.xsd 
http://www.springframework.org/schema/tx
http://www.springframework.org/schema/tx/spring-tx.xsd
http://www.springframework.org/schema/security
http://www.springframework.org/schema/security/spring-security.xsd 
http://www.springframework.org/schema/security/oauth2 
http://www.springframework.org/schema/security/spring-security-oauth2.xsd">


	<!-- Creates a filter chain -->
	<!-- Caused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: 
		No bean named 'org.springframework.security.authenticationManager' is defined: 
		Did you forget to add a gobal <authentication-manager> element to your configuration 
		(with child <authentication-provider> elements)? Alternatively you can use 
		the authentication-manager-ref attribute on your <http> and <global-method-security> 
		ele ments. -->

	<!-- regarding the access decision manager As you've observed, the acl voters 
		don't support filter invocations as they are intended for checking secured 
		methods, not web requests. You should configure a separate AccessDecisionManager 
		for use with your method security and add the acl voters to that -->
	<sec:http use-expressions="true" authentication-manager-ref="userAuthenticationManager"
		entry-point-ref="basicAuthenticationEntryPoint">
		<sec:intercept-url pattern="/endpoint/public"
			access="hasAuthority('ROLE_AUTHOR')" />
		<sec:anonymous enabled="true" />
		<sec:csrf disabled="true" />
		<!-- <sec:http-basic entry-point-ref="basicAuthenticationEntryPoint" /> -->
		<sec:custom-filter ref="basicAuthenticationFilter"
			position="FORM_LOGIN_FILTER " />
	</sec:http>

	<bean id="basicAuthenticationEntryPoint"
		class="org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint">
		<property name="realmName" value="tpns" />
	</bean>

	<sec:authentication-manager id="userAuthenticationManager">
		<sec:authentication-provider>
			<sec:user-service>
				<sec:user name="author" authorities="ROLE_AUTHOR" password="author" />
			</sec:user-service>
		</sec:authentication-provider>
	</sec:authentication-manager>

	<bean id="accessDecisionManager" class="org.springframework.security.access.vote.UnanimousBased">
		<constructor-arg>
			<list>
				<bean
					class="org.springframework.security.web.access.expression.WebExpressionVoter" />
				<bean class="org.springframework.security.access.annotation.Jsr250Voter" />
				<bean class="org.springframework.security.access.vote.RoleVoter">
					<property name="rolePrefix" value="" />
				</bean>
			</list>
		</constructor-arg>
	</bean>

	<sec:global-method-security
		jsr250-annotations="enabled" access-decision-manager-ref="accessDecisionManager">
	</sec:global-method-security>

	<bean id="basicAuthenticationFilter"
		class="org.springframework.security.web.authentication.www.BasicAuthenticationFilter">
		<constructor-arg ref="userAuthenticationManager" />
	</bean>


</beans>